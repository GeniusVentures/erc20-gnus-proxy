<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/ERC20ProxyFacet.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> ERC20ProxyFacet.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/23</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/8</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/11</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/28</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.2;
&nbsp;
import "@gnus.ai/contracts-upgradeable-diamond/proxy/utils/Initializable.sol";
import "@gnus.ai/contracts-upgradeable-diamond/token/ERC20/IERC20Upgradeable.sol";
import "@gnus.ai/contracts-upgradeable-diamond/token/ERC20/ERC20Storage.sol";
import "@gnus.ai/contracts-upgradeable-diamond/token/ERC1155/IERC1155Upgradeable.sol";
import "./ProxyDiamond.sol";
import "./ERC20ProxyStorage.sol";
&nbsp;
/**
 * @title ERC20ProxyFacet
 * @dev Implementation of the ERC20 Proxy Facet using the Diamond Standard.
 */
contract ERC20ProxyFacet is Initializable, IERC20Upgradeable {
    using ERC20ProxyStorage for ERC20ProxyStorage.Layout;
&nbsp;
    /**
     * @notice Initializes the ERC20 Proxy with the given parameters.
     * @param _erc1155Address The address of the ERC1155 contract.
     * @param _childTokenId The ID of the child token in the ERC1155 contract.
     * @param _name The name of the ERC20 token.
     * @param _symbol The symbol of the ERC20 token.
     */
<span class="fstat-no" title="function not covered" >    function initializeERC20Proxy(</span>
        address _erc1155Address,
        uint256 _childTokenId,
        string memory _name,
        string memory _symbol
    ) onlyOwnerRole external {
<span class="cstat-no" title="statement not covered" >        LibDiamond.enforceIsContractOwner()</span>;
<span class="cstat-no" title="statement not covered" >        ERC20ProxyStorage.Layout storage l = ERC20ProxyStorage.layout();</span>
        l.erc1155Contract = ERC1155SupplyUpgradeable(_erc1155Address);
        l.childTokenId = _childTokenId;
        l.name = _name;
        l.symbol = _symbol;
    }
&nbsp;
    /**
     * @notice Returns the name of the token.
     * @return The name of the token.
     */
<span class="fstat-no" title="function not covered" >    function name() external view returns (string memory) {</span>
<span class="cstat-no" title="statement not covered" >        return ERC20ProxyStorage.layout().name;</span>
    }
&nbsp;
    /**
     * @notice Returns the symbol of the token.
     * @return The symbol of the token.
     */
<span class="fstat-no" title="function not covered" >    function symbol() external view returns (string memory) {</span>
<span class="cstat-no" title="statement not covered" >        return ERC20ProxyStorage.layout().symbol;</span>
    }
&nbsp;
    /**
     * @notice Returns the number of decimals used to get its user representation.
     * @return The number of decimals.
     */
<span class="fstat-no" title="function not covered" >    function decimals() external pure returns (uint8) {</span>
<span class="cstat-no" title="statement not covered" >        return 18;</span>
    }
&nbsp;
    /**
     * @notice Returns the total supply of the token.
     * @return The total supply of the token.
     */
<span class="fstat-no" title="function not covered" >    function totalSupply() public view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        ERC20ProxyStorage.Layout storage l = ERC20ProxyStorage.layout();</span>
<span class="cstat-no" title="statement not covered" >        return l.erc1155Contract.totalSupply(l.childTokenId);</span>
    }
&nbsp;
    /**
     * @notice Returns the balance of the specified address.
     * @param account The address to query the balance of.
     * @return The balance of the specified address.
     */
<span class="fstat-no" title="function not covered" >    function balanceOf(address account) public view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        ERC20ProxyStorage.Layout storage l = ERC20ProxyStorage.layout();</span>
<span class="cstat-no" title="statement not covered" >        return l.erc1155Contract.balanceOf(account, l.childTokenId);</span>
    }
&nbsp;
    /**
     * @notice Transfers tokens to a specified address.
     * @param recipient The address to transfer to.
     * @param amount The amount to be transferred.
     * @return A boolean that indicates if the operation was successful.
     */
<span class="fstat-no" title="function not covered" >    function transfer(address recipient, uint256 amount) public override returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        ERC20ProxyStorage.Layout storage l = ERC20ProxyStorage.layout();</span>
<span class="cstat-no" title="statement not covered" >        l.erc1155Contract.safeTransferFrom(msg.sender, recipient, l.childTokenId, amount, "")</span>;
<span class="cstat-no" title="statement not covered" >        emit Transfer(msg.sender, recipient, amount);</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
    /**
     * @notice Returns the amount of tokens that an owner allowed to a spender.
     * @param owner The address which owns the funds.
     * @param spender The address which will spend the funds.
     * @return The amount of tokens still available for the spender.
     */
<span class="fstat-no" title="function not covered" >    function allowance(address owner, address spender) public view override returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return ERC20ProxyStorage.layout().erc1155Contract.isApprovedForAll(owner, spender) ? type(uint256).max : 0;</span>
    }
&nbsp;
    /**
     * @notice Approves the passed address to spend the specified amount of tokens on behalf of msg.sender.
     * @param spender The address which will spend the funds.
     * @param amount The amount of tokens to be spent.
     * @return A boolean that indicates if the operation was successful.
     */
<span class="fstat-no" title="function not covered" >    function approve(address spender, uint256 amount) public override returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        ERC20ProxyStorage.layout().erc1155Contract.setApprovalForAll(spender, amount &gt; 0)</span>;
<span class="cstat-no" title="statement not covered" >        emit Approval(msg.sender, spender, amount);</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
    /**
     * @notice Transfers tokens from one address to another.
     * @param sender The address which you want to send tokens from.
     * @param recipient The address which you want to transfer to.
     * @param amount The amount of tokens to be transferred.
     * @return A boolean that indicates if the operation was successful.
     */
<span class="fstat-no" title="function not covered" >    function transferFrom(address sender, address recipient, uint256 amount) public override returns (bool) {</span>
<span class="cstat-no" title="statement not covered" >        ERC20ProxyStorage.Layout storage l = ERC20ProxyStorage.layout();</span>
<span class="cstat-no" title="statement not covered" >        require(l.erc1155Contract.isApprovedForAll(sender, msg.sender), "ERC20Proxy: transfer caller is not approved")</span>;
<span class="cstat-no" title="statement not covered" >        l.erc1155Contract.safeTransferFrom(sender, recipient, l.childTokenId, amount, "")</span>;
<span class="cstat-no" title="statement not covered" >        emit Transfer(sender, recipient, amount);</span>
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
    /**
     * @dev Modifier to make a function callable only by the contract owner.
     */
<span class="fstat-no" title="function not covered" >    modifier onlyOwnerRole {</span>
<span class="cstat-no" title="statement not covered" >        require(LibDiamond.diamondStorage().contractOwner == msg.sender, "Only Contract Owner allowed")</span>;
        _;
    }
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon Feb 17 2025 10:54:56 GMT-0500 (Eastern Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
